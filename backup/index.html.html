<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Car Audio Analyzer V3 ‚Äî VW Up! TSI 2017</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.7/dist/chart.umd.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box
        }

        :root {
            --bg: #0a0a0f;
            --card: #12121a;
            --card2: #1a1a28;
            --border: #2a2a3a;
            --accent: #6c5ce7;
            --accent2: #a29bfe;
            --green: #00b894;
            --orange: #fdcb6e;
            --red: #e17055;
            --cyan: #81ecec;
            --pink: #fd79a8;
            --text: #e0e0e0;
            --text2: #a0a0b0;
            --gold: #f9ca24
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
            overflow-x: hidden
        }

        .header {
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1040 50%, #0a0a1a 100%);
            padding: 30px 40px;
            border-bottom: 1px solid var(--border);
            text-align: center
        }

        .header h1 {
            font-size: 28px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent2), var(--cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 6px
        }

        .header p {
            color: var(--text2);
            font-size: 14px;
            font-weight: 300
        }

        .header .car-badge {
            display: inline-block;
            background: var(--card2);
            border: 1px solid var(--border);
            border-radius: 20px;
            padding: 4px 16px;
            font-size: 12px;
            color: var(--accent2);
            margin-top: 8px
        }

        .header .version {
            font-size: 10px;
            color: var(--green);
            margin-top: 4px;
            letter-spacing: 1px
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px
        }

        .grid2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 16px;
            margin-bottom: 16px
        }

        .card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            position: relative;
            overflow: hidden
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, var(--accent), transparent)
        }

        .card h2 {
            font-size: 15px;
            font-weight: 700;
            color: var(--accent2);
            margin-bottom: 14px;
            display: flex;
            align-items: center;
            gap: 8px
        }

        .card h2 .icon {
            font-size: 18px
        }

        .card h3 {
            font-size: 13px;
            font-weight: 600;
            color: var(--text2);
            margin: 12px 0 8px;
            text-transform: uppercase;
            letter-spacing: 1px
        }

        .chart-wrap {
            position: relative;
            height: 320px;
            margin: 10px 0
        }

        .chart-wrap.tall {
            height: 420px
        }

        .slider-group {
            margin: 8px 0
        }

        .slider-group label {
            font-size: 12px;
            color: var(--text2);
            display: flex;
            justify-content: space-between;
            margin-bottom: 4px
        }

        .slider-group label span {
            color: var(--accent2);
            font-weight: 600
        }

        input[type=range] {
            -webkit-appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 3px;
            background: var(--card2);
            outline: none;
            border: 1px solid var(--border)
        }

        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 0 10px rgba(108, 92, 231, .5)
        }

        .stat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px
        }

        .stat {
            background: var(--card2);
            border-radius: 10px;
            padding: 12px;
            text-align: center;
            border: 1px solid var(--border)
        }

        .stat .val {
            font-size: 22px;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent2), var(--cyan));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent
        }

        .stat .lbl {
            font-size: 10px;
            color: var(--text2);
            margin-top: 2px;
            text-transform: uppercase;
            letter-spacing: .5px
        }

        .tip {
            background: var(--card2);
            border-left: 3px solid var(--accent);
            border-radius: 0 8px 8px 0;
            padding: 10px 14px;
            font-size: 12px;
            color: var(--text2);
            margin: 10px 0;
            line-height: 1.6
        }

        .tip strong {
            color: var(--green)
        }

        .tip.warn {
            border-left-color: var(--orange)
        }

        .tip.warn strong {
            color: var(--orange)
        }

        .badge {
            display: inline-block;
            padding: 2px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 600
        }

        .badge.on {
            background: rgba(0, 184, 148, .15);
            color: var(--green);
            border: 1px solid rgba(0, 184, 148, .3)
        }

        .badge.off {
            background: rgba(225, 112, 85, .15);
            color: var(--red);
            border: 1px solid rgba(225, 112, 85, .3)
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            margin: 8px 0
        }

        table th {
            text-align: left;
            color: var(--text2);
            font-weight: 600;
            padding: 8px;
            border-bottom: 1px solid var(--border);
            text-transform: uppercase;
            font-size: 10px;
            letter-spacing: .5px
        }

        table td {
            padding: 8px;
            border-bottom: 1px solid rgba(42, 42, 58, .5);
            color: var(--text)
        }

        table tr:hover td {
            background: rgba(108, 92, 231, .05)
        }

        .config-summary {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px
        }

        .config-item {
            background: var(--card2);
            border-radius: 10px;
            padding: 14px;
            border: 1px solid var(--border)
        }

        .config-item .title {
            font-size: 11px;
            color: var(--text2);
            text-transform: uppercase;
            letter-spacing: .5px;
            margin-bottom: 6px
        }

        .config-item .value {
            font-size: 16px;
            font-weight: 700;
            color: var(--accent2)
        }

        .config-item .detail {
            font-size: 11px;
            color: var(--text2);
            margin-top: 4px
        }

        .legend-custom {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin: 8px 0;
            font-size: 11px
        }

        .legend-custom .item {
            display: flex;
            align-items: center;
            gap: 4px
        }

        .legend-custom .dot {
            width: 10px;
            height: 10px;
            border-radius: 50%
        }

        .eq-3band {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 16px;
            margin: 16px 0
        }

        .eq-knob {
            background: var(--card2);
            border-radius: 12px;
            padding: 16px;
            text-align: center;
            border: 1px solid var(--border)
        }

        .eq-knob .band-name {
            font-size: 14px;
            font-weight: 700;
            color: var(--accent2);
            margin-bottom: 4px
        }

        .eq-knob .band-range {
            font-size: 10px;
            color: var(--text2);
            margin-bottom: 10px
        }

        .eq-knob .band-value {
            font-size: 24px;
            font-weight: 800;
            color: var(--cyan);
            margin: 8px 0
        }

        .eq-knob .band-reason {
            font-size: 11px;
            color: var(--text2);
            margin-top: 8px;
            line-height: 1.4
        }

        @media(max-width:900px) {
            .grid2 {
                grid-template-columns: 1fr
            }

            .eq-3band {
                grid-template-columns: 1fr
            }
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>üîä Car Audio Frequency Analyzer</h1>
        <p>Configura√ß√£o Hi-Fi otimizada para m√°ximo Sound Quality + Volume</p>
        <div class="car-badge">üöó VW Up! TSI 2017 ‚Äî Cabine ~2.6 m¬≥</div>
        <div class="version">V3 ‚Äî EQ 3 Bandas ‚Ä¢ Conversor RCA 5V ‚Ä¢ Decomposi√ß√£o por Driver</div>
    </div>
    <div class="container">

        <!-- Equipment Overview -->
        <div class="card" style="margin-bottom:16px">
            <h2><span class="icon">üìã</span> Equipamentos Instalados</h2>
            <table>
                <tr>
                    <th>Componente</th>
                    <th>Modelo</th>
                    <th>Pot√™ncia RMS</th>
                    <th>Imped√¢ncia</th>
                    <th>Sensibilidade</th>
                    <th>Faixa</th>
                </tr>
                <tr>
                    <td>M√≥dulo</td>
                    <td>SoundDigital 800.4 EVO6</td>
                    <td>4√ó132W@4Œ© / Bridge 2√ó400W@4Œ©</td>
                    <td>‚Äî</td>
                    <td>SNR 93dB</td>
                    <td>5Hz‚Äì20kHz</td>
                </tr>
                <tr>
                    <td>Kit 2 Vias (por porta)</td>
                    <td>Hertz DSK 165.3 + Crossover passivo</td>
                    <td>80W/lado</td>
                    <td>4Œ©</td>
                    <td>93 dB</td>
                    <td>50Hz‚Äì23kHz</td>
                </tr>
                <tr>
                    <td>Subwoofer (caixa dutada)</td>
                    <td>Hertz ES 200.5</td>
                    <td>200W</td>
                    <td>4Œ©</td>
                    <td>87 dB</td>
                    <td>30Hz‚Äì400Hz</td>
                </tr>
                <tr>
                    <td>Tratamento</td>
                    <td>Manta viscoel√°stica (portas)</td>
                    <td>‚Äî</td>
                    <td>‚Äî</td>
                    <td>‚Äî</td>
                    <td>Absor√ß√£o resson√¢ncia</td>
                </tr>
                <tr>
                    <td>Conversor RCA</td>
                    <td>Hi-Lo Converter</td>
                    <td>‚Äî</td>
                    <td>‚Äî</td>
                    <td>5V RMS</td>
                    <td>Sinal de refer√™ncia amplificado</td>
                </tr>
            </table>
        </div>

        <!-- Gain Controls + SPL -->
        <div class="grid2">
            <div class="card">
                <h2><span class="icon">üéõÔ∏è</span> Controle de Ganho ‚Äî M√≥dulo SD 800.4</h2>
                <div class="slider-group">
                    <label>Ganho Canais 1+2 (Frente ‚Äî Kit 2 Vias) <span id="gainFrontVal">78%</span></label>
                    <input type="range" id="gainFront" min="0" max="100" value="78" oninput="updateAll()">
                </div>
                <div class="slider-group">
                    <label>Ganho Canais 3+4 Bridge (Subwoofer) <span id="gainSubVal">65%</span></label>
                    <input type="range" id="gainSub" min="0" max="100" value="65" oninput="updateAll()">
                </div>
                <h3>Filtros do M√≥dulo</h3>
                <div class="slider-group">
                    <label>HPF Frente (Hz) <span id="hpfVal">80 Hz</span></label>
                    <input type="range" id="hpfFreq" min="50" max="150" value="80" step="5" oninput="updateAll()">
                </div>
                <div class="slider-group">
                    <label>LPF Sub (Hz) <span id="lpfVal">80 Hz</span></label>
                    <input type="range" id="lpfFreq" min="50" max="150" value="80" step="5" oninput="updateAll()">
                </div>
                <div class="slider-group">
                    <label>Volume da Fonte (Head Unit) <span id="volVal">75%</span></label>
                    <input type="range" id="volSource" min="0" max="100" value="75" oninput="updateAll()">
                </div>
                <div class="tip"><strong>Dica:</strong> Os valores padr√£o representam a configura√ß√£o √≥tima calculada
                    para Hi-Fi com graves profundos equilibrados (~+6dB). Ajuste para explorar.</div>
            </div>
            <div class="card">
                <h2><span class="icon">üìä</span> SPL Estimado ‚Äî Banco do Motorista</h2>
                <div class="stat-grid">
                    <div class="stat">
                        <div class="val" id="splFront">‚Äî</div>
                        <div class="lbl">Frente (Kit 2V)</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="splSub">‚Äî</div>
                        <div class="lbl">Subwoofer</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="splTotal">‚Äî</div>
                        <div class="lbl">Sistema Total</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="splPeak">‚Äî</div>
                        <div class="lbl">Pico Estimado</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="pwrFront">‚Äî</div>
                        <div class="lbl">Pot√™ncia Frente</div>
                    </div>
                    <div class="stat">
                        <div class="val" id="pwrSub">‚Äî</div>
                        <div class="lbl">Pot√™ncia Sub</div>
                    </div>
                </div>
                <div class="tip warn" style="margin-top:14px"><strong>‚ö†Ô∏è Aten√ß√£o:</strong> O sub Hertz ES 200.5 suporta
                    apenas 200W RMS. Com o bridge entregando at√© 400W, <u>nunca passe de ~75% do ganho</u> nesse canal
                    para evitar danos.</div>
                <h3>Canaliza√ß√£o</h3>
                <div class="config-summary">
                    <div class="config-item">
                        <div class="title">Canal 1</div>
                        <div class="value">Porta Esquerda</div>
                        <div class="detail">Kit 2 Vias Hertz + Crossover passivo</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Canal 2</div>
                        <div class="value">Porta Direita</div>
                        <div class="detail">Kit 2 Vias Hertz + Crossover passivo</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Canal 3+4</div>
                        <div class="value">Bridge ‚Üí Sub</div>
                        <div class="detail">Hertz ES 200.5 ‚Äî Caixa dutada MDF</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Filtros</div>
                        <div class="value">HPF 80Hz / LPF 80Hz</div>
                        <div class="detail">12dB/oitava no m√≥dulo</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Individual Curves -->
        <div class="card" style="margin-bottom:16px">
            <h2><span class="icon">üìà</span> Curvas de Frequ√™ncia Individuais dos Componentes</h2>
            <div class="legend-custom">
                <div class="item">
                    <div class="dot" style="background:#a29bfe"></div> Kit 2 Vias (com crossover passivo)
                </div>
                <div class="item">
                    <div class="dot" style="background:#fd79a8"></div> Mid-Bass (via crossover)
                </div>
                <div class="item">
                    <div class="dot" style="background:#81ecec"></div> Tweeter (via crossover)
                </div>
                <div class="item">
                    <div class="dot" style="background:#e17055"></div> Subwoofer (caixa dutada)
                </div>
            </div>
            <div class="chart-wrap tall"><canvas id="chartIndividual"></canvas></div>
        </div>

        <!-- Combined System Response -->
        <div class="card" style="margin-bottom:16px">
            <h2><span class="icon">üéØ</span> Resposta Combinada do Sistema ‚Äî Banco do Motorista</h2>
            <div class="legend-custom">
                <div class="item">
                    <div class="dot" style="background:#6c5ce7"></div> Resposta Total Estimada
                </div>
                <div class="item">
                    <div class="dot" style="background:rgba(249,202,36,.5)"></div> Curva-Alvo Hi-Fi (Harman)
                </div>
                <div class="item">
                    <div class="dot" style="background:rgba(0,184,148,.3)"></div> Zona Ideal ¬±3dB
                </div>
            </div>
            <div class="chart-wrap tall"><canvas id="chartCombined"></canvas></div>
            <div class="tip"><strong>Interpreta√ß√£o:</strong> A curva roxa √© a resposta estimada no banco do motorista. A
                curva dourada √© a refer√™ncia Hi-Fi (Harman target + bass shelf moderado ~+6dB para seu gosto de graves
                profundos). Quanto mais pr√≥ximas, melhor o sound quality.</div>
        </div>

        <!-- Decomposition Chart -->
        <div class="card" style="margin-bottom:16px">
            <h2><span class="icon">üî¨</span> Decomposi√ß√£o da Resposta ‚Äî Contribui√ß√£o por Driver</h2>
            <div class="legend-custom">
                <div class="item">
                    <div class="dot" style="background:#6c5ce7"></div> Resposta Combinada
                </div>
                <div class="item">
                    <div class="dot" style="background:#e17055"></div> Subwoofer (processado)
                </div>
                <div class="item">
                    <div class="dot" style="background:#fd79a8"></div> Mid-Bass (processado)
                </div>
                <div class="item">
                    <div class="dot" style="background:#81ecec"></div> Tweeter (processado)
                </div>
                <div class="item">
                    <div class="dot" style="background:rgba(249,202,36,.5)"></div> Curva-Alvo Hi-Fi
                </div>
            </div>
            <div class="chart-wrap tall"><canvas id="chartDecomp"></canvas></div>
            <div class="tip"><strong>Como ler:</strong> Cada curva mostra a contribui√ß√£o individual de cada driver J√Å
                COM todos os processamentos (filtros, ganho, cabin gain). Onde duas curvas se sobrep√µem, ambos os
                drivers contribuem para aquela faixa. A curva roxa (total) √© a soma ac√∫stica de todos. Identifique qual
                driver domina em cada regi√£o.</div>
        </div>

        <!-- Filters Chart -->
        <div class="card" style="margin-bottom:16px">
            <h2><span class="icon">üîÄ</span> Ponto de Crossover e Filtros Ativos</h2>
            <div class="legend-custom">
                <div class="item">
                    <div class="dot" style="background:#00b894"></div> HPF Frente
                </div>
                <div class="item">
                    <div class="dot" style="background:#e17055"></div> LPF Sub
                </div>
                <div class="item">
                    <div class="dot" style="background:#fdcb6e"></div> Crossover Passivo 3.5kHz
                </div>
            </div>
            <div class="chart-wrap"><canvas id="chartFilters"></canvas></div>
        </div>

        <!-- EQ 3 Bandas + Config -->
        <div class="grid2">
            <div class="card">
                <h2><span class="icon">üéöÔ∏è</span> EQ Recomendado ‚Äî R√°dio Original VW Up! (3 Bandas)</h2>
                <p style="font-size:12px;color:var(--text2);margin-bottom:6px">O r√°dio original do Up! TSI 2017 possui
                    apenas <strong style="color:var(--accent2)">3 bandas de equaliza√ß√£o: Bass, Mid e Treble</strong>.
                    Abaixo est√£o os ajustes otimizados para o seu sistema com m√≥dulo amplificado.</p>
                <div class="eq-3band">
                    <div class="eq-knob">
                        <div class="band-name">üîà BASS</div>
                        <div class="band-range">Regi√£o: ~60‚Äì250 Hz</div>
                        <div class="band-value">-2</div>
                        <div class="band-reason">O sub + cabin gain j√° entregam graves com sobra. Reduzir Bass na fonte
                            evita <strong style="color:var(--orange)">boom e embolamento</strong> na regi√£o de
                            150‚Äì250Hz. Isso limpa a transi√ß√£o sub ‚Üí mid-bass.</div>
                    </div>
                    <div class="eq-knob">
                        <div class="band-name">üéôÔ∏è MID</div>
                        <div class="band-range">Regi√£o: ~500‚Äì2000 Hz</div>
                        <div class="band-value">+1</div>
                        <div class="band-reason">Leve boost compensa a <strong style="color:var(--cyan)">atenua√ß√£o
                                natural da cabine</strong> nos m√©dios. Melhora presen√ßa vocal, clareza de instrumentos e
                            inteligibilidade. A manta ac√∫stica ajuda nessa regi√£o.</div>
                    </div>
                    <div class="eq-knob">
                        <div class="band-name">‚ú® TREBLE</div>
                        <div class="band-range">Regi√£o: ~4000‚Äì16000 Hz</div>
                        <div class="band-value">0</div>
                        <div class="band-reason">O tweeter PEI do Hertz DSK 165.3 j√° tem <strong
                                style="color:var(--green)">√≥tima extens√£o at√© 23kHz</strong> com presen√ßa natural.
                            Deixar flat evita sibil√¢ncia e fadiga auditiva em viagens longas.</div>
                    </div>
                </div>
                <div class="tip"><strong>Importante:</strong> Deixe <strong>Loudness DESLIGADO</strong> e qualquer
                    <strong>Bass Boost DESLIGADO</strong> no r√°dio ‚Äî o m√≥dulo SoundDigital j√° cuida da amplifica√ß√£o.
                    Comece na posi√ß√£o "Flat" e aplique estes valores.
                </div>
                <div class="tip warn"><strong>Dica Pro:</strong> Se sentir que falta "corpo" nos vocais, experimente Mid
                    em +2. Se quiser mais "ar" e brilho nos pratos da bateria, experimente Treble em +1. Ajuste fino ao
                    seu gosto!</div>
            </div>
            <div class="card">
                <h2><span class="icon">‚úÖ</span> Configura√ß√£o Final Recomendada</h2>
                <div class="config-summary">
                    <div class="config-item">
                        <div class="title">Ganho Frente (Ch 1+2)</div>
                        <div class="value" id="cfgGainF">78%</div>
                        <div class="detail" id="cfgPwrF">‚âà 80W por canal</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Ganho Sub (Ch 3+4 Bridge)</div>
                        <div class="value" id="cfgGainS">65%</div>
                        <div class="detail" id="cfgPwrS">‚âà 169W bridge</div>
                    </div>
                    <div class="config-item">
                        <div class="title">HPF Frente</div>
                        <div class="value" id="cfgHPF">80 Hz</div>
                        <div class="detail">12dB/oitava ‚Äî Ligado</div>
                    </div>
                    <div class="config-item">
                        <div class="title">LPF Sub</div>
                        <div class="value" id="cfgLPF">80 Hz</div>
                        <div class="detail">12dB/oitava ‚Äî Ligado</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Volume Fonte</div>
                        <div class="value" id="cfgVol">75%</div>
                        <div class="detail">Sem distor√ß√£o no sinal RCA</div>
                    </div>
                    <div class="config-item">
                        <div class="title">Crossover Passivo</div>
                        <div class="value">3.5 kHz</div>
                        <div class="detail">12dB/oct ‚Äî Integrado no kit Hertz</div>
                    </div>
                </div>
                <h3 style="margin-top:16px">Checklist de Instala√ß√£o</h3>
                <table>
                    <tr>
                        <td>‚úÖ</td>
                        <td>Manta ac√∫stica nas portas dianteiras</td>
                        <td class="badge on">Essencial</td>
                    </tr>
                    <tr>
                        <td>‚úÖ</td>
                        <td>Crossover passivo Hertz entre m√≥dulo e falantes</td>
                        <td class="badge on">Usar o do kit</td>
                    </tr>
                    <tr>
                        <td>‚úÖ</td>
                        <td>Cabo de alimenta√ß√£o 7 AWG (10mm¬≤)</td>
                        <td class="badge on">Obrigat√≥rio</td>
                    </tr>
                    <tr>
                        <td>‚úÖ</td>
                        <td>Fus√≠vel 40A perto da bateria</td>
                        <td class="badge on">Seguran√ßa</td>
                    </tr>
                    <tr>
                        <td>‚úÖ</td>
                        <td>Aterramento curto e s√≥lido</td>
                        <td class="badge on">Performance</td>
                    </tr>
                    <tr>
                        <td>‚ö†Ô∏è</td>
                        <td>Cabos RCA blindados</td>
                        <td class="badge on">Recomendado</td>
                    </tr>
                    <tr>
                        <td>‚ö†Ô∏è</td>
                        <td>Tratar porta-malas (futuro)</td>
                        <td class="badge off">Opcional</td>
                    </tr>
                </table>
            </div>
        </div>

        <!-- Analysis Text -->
        <div class="card" style="margin-top:16px">
            <h2><span class="icon">üß†</span> An√°lise T√©cnica Detalhada</h2>
            <div
                style="display:grid;grid-template-columns:1fr 1fr;gap:16px;font-size:12px;line-height:1.7;color:var(--text2)">
                <div>
                    <h3>Integra√ß√£o Sub + Kit 2 Vias</h3>
                    <p>O ponto de crossover entre sub e kit frontal em <strong style="color:var(--green)">80 Hz</strong>
                        √© ideal: o Hertz DSK 165.3 tem resposta a partir de 50Hz mas com excurs√£o excessiva abaixo de
                        80Hz; o HPF protege o mid-bass e reduz distor√ß√£o. O sub cobre 30‚Äì80Hz com sobra.</p>
                    <h3 style="margin-top:14px">Sub-Bass Controlado (~+6dB)</h3>
                    <p>Na V2, o ganho do sub foi ajustado de 71% para <strong style="color:var(--cyan)">65%</strong>
                        para trazer o pico de 50Hz para pr√≥ximo de <strong style="color:var(--gold)">+6dB</strong> em
                        vez de +9dB. Isso entrega graves profundos e marcantes sem exagero, mantendo extens√£o suave at√©
                        ~30Hz pela caixa dutada. O resultado √© um grave com <strong style="color:var(--green)">presen√ßa
                            e peso, mas sem mascarar os m√©dios</strong>.</p>
                    <h3 style="margin-top:14px">Cabin Gain</h3>
                    <p>A cabine do Up! (~2.6m¬≥) gera <strong style="color:var(--cyan)">cabin gain de +6 a +10dB</strong>
                        abaixo de 60Hz. Com o ganho moderado do sub, o pico fica controlado em ~+6dB, entregando impacto
                        sem excesso.</p>
                </div>
                <div>
                    <h3>Zona de M√©dios (200‚Äì550Hz) ‚Äî An√°lise Honesta</h3>
                    <p>A leve depress√£o na faixa de 200‚Äì550Hz √© <strong style="color:var(--orange)">caracter√≠stica
                            inerente</strong> a este tipo de instala√ß√£o. Causas:</p>
                    <p style="margin:6px 0">‚Ä¢ <strong>Ac√∫stica da porta:</strong> O mid-bass de 6.5" montado na porta
                        sofre cancelamentos por reflex√µes internas na cavidade da porta ‚Äî a manta reduz isso
                        significativamente (de ~-4dB para ~-1.5dB), mas n√£o elimina totalmente.</p>
                    <p style="margin:6px 0">‚Ä¢ <strong>Zona de transi√ß√£o sub‚Üímid:</strong> Com HPF em 80Hz e a resposta
                        natural do mid-bass, h√° uma leve "sela" entre as contribui√ß√µes do sub e do kit frontal.</p>
                    <p style="margin:6px 0">‚Ä¢ <strong>Crossover passivo:</strong> Sem processamento DSP ativo, n√£o h√°
                        como aplicar EQ param√©trica pontual nessa faixa.</p>
                    <p style="margin-top:10px"><strong style="color:var(--green)">Veredicto:</strong> Para seu sistema
                        (m√≥dulo anal√≥gico + crossover passivo), esta √© a <strong>melhor resposta ating√≠vel</strong>
                        nessa regi√£o. A manta ac√∫stica √© o diferencial que mant√©m a depress√£o em ~-1.5dB (aceit√°vel para
                        Hi-Fi). Um DSP futuro seria o upgrade que eliminaria completamente essa limita√ß√£o.</p>
                    <h3 style="margin-top:14px">Seu Perfil Sonoro</h3>
                    <p>Curva-alvo: <strong style="color:var(--gold)">Harman Target</strong> com <strong
                            style="color:var(--pink)">bass shelf de +6dB</strong> ‚Äî graves profundos com destaque
                        equilibrado, m√©dios fi√©is e detalhados, agudos arejados sem sibil√¢ncia.</p>
                </div>
            </div>
        </div>

    </div>

    <!-- Volume Sensation Note -->
    <div class="card" style="margin-top:16px">
        <h2><span class="icon">üéß</span> Sensa√ß√£o Sonora por Volume ‚Äî Conversor RCA 5V</h2>
        <div style="font-size:12px;line-height:1.7;color:var(--text2)">
            <p style="margin-bottom:10px">Seu conversor RCA entrega <strong style="color:var(--cyan)">5V RMS</strong>
                (vs ~2V t√≠pico de head units). Isso d√° ao sistema <strong style="color:var(--green)">+8dB de
                    headroom</strong> ‚Äî sinal mais limpo, mais pot√™ncia dispon√≠vel e menos distor√ß√£o em qualquer volume.
            </p>
            <table id="volSensationTable">
                <tr>
                    <th>Volume</th>
                    <th>SPL Sistema</th>
                    <th>Pot√™ncia Frente</th>
                    <th>Pot√™ncia Sub</th>
                    <th>Sensa√ß√£o</th>
                </tr>
            </table>
            <div style="margin-top:14px">
                <h3>üîâ Abaixo de 75% ‚Äî Modo Conforto</h3>
                <p>O sistema opera em territ√≥rio <strong style="color:var(--green)">totalmente linear</strong>. O sub
                    trabalha suave, sem esfor√ßo ‚Äî graves presentes mas educados. Os m√©dios s√£o detalhados e l√≠mpidos,
                    vocais ganham nuance. Os agudos do tweeter PEI ficam arejados, pratos da bateria com brilho
                    delicado. Ideal para <strong>conversas no carro, viagens longas, e aprecia√ß√£o musical
                        relaxada</strong>. O cabin gain mal se faz notar. Sensa√ß√£o de sistema Hi-Fi de sala:
                    equilibrado, transparente, sem fadiga.</p>
                <h3 style="margin-top:14px">üéØ 75% ‚Äî Sweet Spot Calibrado</h3>
                <p>Este √© o <strong style="color:var(--gold)">ponto √≥timo calculado</strong>. O bass shelf atinge ~+6dB
                    ‚Äî graves profundos que voc√™ sente no peito sem dominar a mixagem. M√©dios com presen√ßa firme.
                    Tweeters definidos. O sistema opera em sua faixa <strong style="color:var(--green)">ideal de
                        efici√™ncia</strong> ‚Äî amplo headroom gra√ßas ao conversor 5V, m√≥dulo confort√°vel, drivers dentro
                    de suas capacidades. Neste volume, a resposta de frequ√™ncia segue mais de perto a <strong
                        style="color:var(--gold)">curva Harman Target</strong>.</p>
                <h3 style="margin-top:14px">üîä Acima de 75% ‚Äî Modo Performance</h3>
                <p>O cabin gain amplifica significativamente os graves ‚Äî a press√£o sonora abaixo de 60Hz cresce r√°pido.
                    O sub come√ßa a trabalhar mais perto do seu limite de 200W RMS. Graves ficam <strong
                        style="color:var(--orange)">viscerais e envolventes</strong>. Vocais podem come√ßar a competir
                    com o bass em volumes extremos (>90%). O conversor 5V mant√©m o sinal limpo mesmo aqui ‚Äî a distor√ß√£o
                    que voc√™ ouviria com um head unit convencional de 2V <strong style="color:var(--green)">n√£o
                        acontece</strong>. Acima de 90%, monitore a temperatura do sub e do m√≥dulo. <strong
                        style="color:var(--red)">N√£o ultrapasse 75% no ganho do sub</strong> para proteger o Hertz ES
                    200.5.</p>
            </div>
        </div>
    </div>

    </div>

    <script>
        function genFreqs() { const f = []; for (let i = Math.log10(20); i <= Math.log10(20000); i += 0.02)f.push(Math.pow(10, i)); return f }
        const freqs = genFreqs();

        // RCA Converter: 5V output (vs typical 2V)
        const vRCA = 5.0;
        const vRef = 2.0;
        const rcaBoostDB = 20 * Math.log10(vRCA / vRef); // ~+7.96 dB

        function hpf12(f, fc) { const r = fc / f; return -10 * Math.log10(1 + Math.pow(r, 4)) }
        function lpf12(f, fc) { const r = f / fc; return -10 * Math.log10(1 + Math.pow(r, 4)) }

        function subResponse(f) {
            if (f < 20) return -40;
            const ft = 50;
            let spl = 0;
            const peak = 2.2 * Math.exp(-Math.pow((f - ft) / 18, 2));
            const loRoll = f < ft ? -15 * Math.log10(ft / f) : 0;
            const hiRoll = f > 200 ? -12 * Math.log10(f / 200) : 0;
            spl = peak + loRoll + hiRoll;
            return Math.max(spl, -40);
        }

        function midBassResponse(f) {
            if (f < 30) return -40;
            let spl = 0;
            if (f < 50) spl = -12 * Math.log10(50 / f);
            spl += 2 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(120)) / 0.3, 2));
            spl -= 1.0 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(450)) / 0.22, 2));
            spl += 1 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(2500)) / 0.15, 2));
            spl += lpf12(f, 3500);
            return Math.max(spl, -40);
        }

        function tweeterResponse(f) {
            if (f < 1000) return -40;
            let spl = 0;
            spl += hpf12(f, 3500);
            spl += 2 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(6000)) / 0.2, 2));
            if (f > 18000) spl -= 12 * Math.log10(f / 18000);
            spl += 1 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(10000)) / 0.25, 2));
            return Math.max(spl, -40);
        }

        function kitResponse(f) {
            const mbdB = midBassResponse(f);
            const twdB = tweeterResponse(f);
            return 10 * Math.log10(Math.pow(10, mbdB / 10) + Math.pow(10, twdB / 10));
        }

        function cabinTF(f) {
            let gain = 0;
            if (f < 200) { gain += 7 * Math.pow(Math.max(0, (200 - f) / 200), 1.3); }
            gain += 1.2 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(65)) / 0.1, 2));
            gain += 0.8 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(130)) / 0.08, 2));
            gain -= 1.5 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(250)) / 0.12, 2));
            gain += 0.6 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(180)) / 0.1, 2));
            if (f > 5000) gain -= 2 * Math.log10(f / 5000);
            return gain;
        }

        function harmanTarget(f) {
            let t = 0;
            if (f < 200) { t = 6 * Math.pow(Math.max(0, (200 - f) / 200), 0.6); }
            if (f > 1000) t -= 0.5 * Math.log2(f / 1000);
            t += 1 * Math.exp(-Math.pow((Math.log10(f) - Math.log10(3000)) / 0.2, 2));
            return t;
        }

        let chartIndividual, chartCombined, chartDecomp, chartFilters;

        function initCharts() {
            const commonOpts = {
                responsive: true, maintainAspectRatio: false,
                scales: {
                    x: {
                        type: 'logarithmic', min: 20, max: 20000, title: { display: true, text: 'Frequ√™ncia (Hz)', color: '#a0a0b0', font: { size: 11 } },
                        ticks: {
                            color: '#a0a0b0', font: { size: 9 }, callback: function (v) {
                                const nice = [20, 30, 50, 80, 100, 200, 500, 1000, 2000, 5000, 10000, 20000];
                                if (nice.includes(Math.round(v))) return v < 1000 ? v + 'Hz' : (v / 1000) + 'kHz'; return ''
                            }
                        }, grid: { color: 'rgba(42,42,58,.5)' }
                    },
                    y: {
                        min: -30, max: 15, title: { display: true, text: 'SPL Relativo (dB)', color: '#a0a0b0', font: { size: 11 } },
                        ticks: { color: '#a0a0b0', font: { size: 9 } }, grid: { color: 'rgba(42,42,58,.3)' }
                    }
                },
                plugins: {
                    legend: { display: false }, tooltip: {
                        mode: 'index', intersect: false, callbacks: {
                            title: function (items) { const f = items[0].parsed.x; return f < 1000 ? Math.round(f) + ' Hz' : (f / 1000).toFixed(1) + ' kHz' },
                            label: function (ctx) { return ctx.dataset.label + ': ' + (ctx.parsed.y).toFixed(1) + ' dB' }
                        }
                    }
                },
                interaction: { mode: 'nearest', axis: 'x', intersect: false },
                elements: { point: { radius: 0 }, line: { tension: 0.3 } }
            };

            chartIndividual = new Chart(document.getElementById('chartIndividual'), {
                type: 'line', data: {
                    labels: freqs, datasets: [
                        { label: 'Kit 2 Vias (sistema)', data: [], borderColor: '#a29bfe', backgroundColor: 'rgba(162,155,254,.1)', borderWidth: 2.5, fill: true },
                        { label: 'Mid-Bass (via crossover)', data: [], borderColor: '#fd79a8', borderWidth: 1.5, borderDash: [5, 3] },
                        { label: 'Tweeter (via crossover)', data: [], borderColor: '#81ecec', borderWidth: 1.5, borderDash: [5, 3] },
                        { label: 'Subwoofer (caixa dutada)', data: [], borderColor: '#e17055', backgroundColor: 'rgba(225,112,85,.1)', borderWidth: 2.5, fill: true }
                    ]
                }, options: { ...commonOpts }
            });

            const combinedOpts = JSON.parse(JSON.stringify(commonOpts));
            combinedOpts.scales.y.min = -20; combinedOpts.scales.y.max = 20;
            chartCombined = new Chart(document.getElementById('chartCombined'), {
                type: 'line', data: {
                    labels: freqs, datasets: [
                        { label: 'Resposta Total (banco motorista)', data: [], borderColor: '#6c5ce7', backgroundColor: 'rgba(108,92,231,.15)', borderWidth: 3, fill: true },
                        { label: 'Curva-Alvo Hi-Fi (Harman+Bass)', data: [], borderColor: 'rgba(249,202,36,.7)', borderWidth: 2, borderDash: [8, 4] },
                        { label: 'Zona Ideal +3dB', data: [], borderColor: 'rgba(0,184,148,.2)', backgroundColor: 'rgba(0,184,148,.05)', borderWidth: 1, fill: '+1' },
                        { label: 'Zona Ideal -3dB', data: [], borderColor: 'rgba(0,184,148,.2)', backgroundColor: 'rgba(0,184,148,.05)', borderWidth: 1 }
                    ]
                }, options: combinedOpts
            });

            // Decomposition chart
            const decompOpts = JSON.parse(JSON.stringify(commonOpts));
            decompOpts.scales.y.min = -20; decompOpts.scales.y.max = 20;
            chartDecomp = new Chart(document.getElementById('chartDecomp'), {
                type: 'line', data: {
                    labels: freqs, datasets: [
                        { label: 'Resposta Combinada', data: [], borderColor: '#6c5ce7', backgroundColor: 'rgba(108,92,231,.10)', borderWidth: 3, fill: true },
                        { label: 'Subwoofer (processado)', data: [], borderColor: '#e17055', borderWidth: 2, backgroundColor: 'rgba(225,112,85,.06)', fill: true },
                        { label: 'Mid-Bass (processado)', data: [], borderColor: '#fd79a8', borderWidth: 2, backgroundColor: 'rgba(253,121,168,.06)', fill: true },
                        { label: 'Tweeter (processado)', data: [], borderColor: '#81ecec', borderWidth: 2, backgroundColor: 'rgba(129,236,236,.06)', fill: true },
                        { label: 'Curva-Alvo Hi-Fi', data: [], borderColor: 'rgba(249,202,36,.5)', borderWidth: 2, borderDash: [8, 4] }
                    ]
                }, options: decompOpts
            });

            const filterOpts = JSON.parse(JSON.stringify(commonOpts));
            filterOpts.scales.y.min = -35; filterOpts.scales.y.max = 5;
            chartFilters = new Chart(document.getElementById('chartFilters'), {
                type: 'line', data: {
                    labels: freqs, datasets: [
                        { label: 'HPF Frente', data: [], borderColor: '#00b894', borderWidth: 2.5 },
                        { label: 'LPF Sub', data: [], borderColor: '#e17055', borderWidth: 2.5 },
                        { label: 'Crossover Passivo 3.5kHz (LPF Woofer)', data: [], borderColor: '#fdcb6e', borderWidth: 1.5, borderDash: [5, 3] },
                        { label: 'Crossover Passivo 3.5kHz (HPF Tweeter)', data: [], borderColor: '#81ecec', borderWidth: 1.5, borderDash: [5, 3] }
                    ]
                }, options: filterOpts
            });

            updateAll();
        }

        function calcSPLat(gF, gS, hpfV, lpfV, volPct) {
            const vF = volPct / 100;
            const pwrF = 132 * Math.pow(gF / 100, 2);
            const pwrS = 400 * Math.pow(gS / 100, 2);
            const splF = 93 + 10 * Math.log10(Math.max(0.1, pwrF * vF)) + rcaBoostDB;
            const splS = 87 + 10 * Math.log10(Math.max(0.1, pwrS * vF)) + rcaBoostDB;
            const sFB = splF + 3;
            const sCab = splS + 8;
            const sSys = 10 * Math.log10(Math.pow(10, sFB / 10) + Math.pow(10, sCab / 10));
            return { splF: sFB, splS: sCab, splSys: sSys, pwrF: pwrF * vF, pwrS: pwrS * vF };
        }

        function updateVolSensationTable(gF, gS, hpf, lpf) {
            const levels = [
                { vol: 25, label: 'üîà 25%', desc: 'Som ambiente suave. Ideal para falar ao telefone. Sub quase inaud√≠vel.' },
                { vol: 50, label: 'üîâ 50%', desc: 'Audi√ß√£o casual. Graves leves, m√©dios claros, agudos presentes. Conforto total.' },
                { vol: 75, label: 'üéØ 75%', desc: 'Sweet spot Hi-Fi. Bass shelf +6dB, m√©dios firmes. Ponto √≥timo calibrado.' },
                { vol: 90, label: 'üîä 90%', desc: 'Alta performance. Graves viscerais, sub trabalhando forte. Aten√ß√£o √† temperatura.' },
                { vol: 100, label: 'üîä 100%', desc: 'Volume m√°ximo. Sub pr√≥ximo ao limite. Monitorar aquecimento. Sinal limpo (5V RCA).' }
            ];
            let html = '<tr><th>Volume</th><th>SPL Sistema</th><th>W Frente</th><th>W Sub</th><th>Sensa√ß√£o</th></tr>';
            levels.forEach(l => {
                const r = calcSPLat(gF, gS, hpf, lpf, l.vol);
                const isCurrent = l.vol === 75 ? ' style="background:rgba(108,92,231,.1);font-weight:600"' : '';
                html += `<tr${isCurrent}><td>${l.label}</td><td>${r.splSys.toFixed(1)} dB</td><td>${r.pwrF.toFixed(0)}W/ch</td><td>${r.pwrS.toFixed(0)}W brg</td><td style="font-size:11px">${l.desc}</td></tr>`;
            });
            document.getElementById('volSensationTable').innerHTML = html;
        }

        function updateAll() {
            const gF = parseInt(document.getElementById('gainFront').value);
            const gS = parseInt(document.getElementById('gainSub').value);
            const hpf = parseInt(document.getElementById('hpfFreq').value);
            const lpf = parseInt(document.getElementById('lpfFreq').value);
            const vol = parseInt(document.getElementById('volSource').value);

            document.getElementById('gainFrontVal').textContent = gF + '%';
            document.getElementById('gainSubVal').textContent = gS + '%';
            document.getElementById('hpfVal').textContent = hpf + ' Hz';
            document.getElementById('lpfVal').textContent = lpf + ' Hz';
            document.getElementById('volVal').textContent = vol + '%';

            const maxPwrFront = 132, maxPwrSub = 400;
            const pwrF = maxPwrFront * Math.pow(gF / 100, 2);
            const pwrS = maxPwrSub * Math.pow(gS / 100, 2);
            const volFactor = vol / 100;

            const sensF = 93, sensS = 87;
            // 5V RCA boost applied to SPL calculations
            const splF = sensF + 10 * Math.log10(Math.max(0.1, pwrF * volFactor)) + rcaBoostDB;
            const splS = sensS + 10 * Math.log10(Math.max(0.1, pwrS * volFactor)) + rcaBoostDB;
            const cabinBoostSub = 8;
            const splSCabin = splS + cabinBoostSub;
            const splFBoth = splF + 3;
            const splSys = 10 * Math.log10(Math.pow(10, splFBoth / 10) + Math.pow(10, splSCabin / 10));

            document.getElementById('splFront').textContent = splFBoth.toFixed(1) + ' dB';
            document.getElementById('splSub').textContent = splSCabin.toFixed(1) + ' dB';
            document.getElementById('splTotal').textContent = splSys.toFixed(1) + ' dB';
            document.getElementById('splPeak').textContent = (splSys + 3).toFixed(1) + ' dB';
            document.getElementById('pwrFront').textContent = (pwrF * volFactor).toFixed(0) + 'W/ch';
            document.getElementById('pwrSub').textContent = (pwrS * volFactor).toFixed(0) + 'W brg';

            document.getElementById('cfgGainF').textContent = gF + '%';
            document.getElementById('cfgGainS').textContent = gS + '%';
            document.getElementById('cfgHPF').textContent = hpf + ' Hz';
            document.getElementById('cfgLPF').textContent = lpf + ' Hz';
            document.getElementById('cfgVol').textContent = vol + '%';
            document.getElementById('cfgPwrF').textContent = '‚âà ' + (pwrF * volFactor).toFixed(0) + 'W por canal';
            document.getElementById('cfgPwrS').textContent = '‚âà ' + (pwrS * volFactor).toFixed(0) + 'W bridge';

            // RCA 5V boost applied to curve gain calculations
            const gainFdB = 20 * Math.log10(Math.max(0.01, gF / 100)) + 20 * Math.log10(Math.max(0.01, volFactor)) + rcaBoostDB;
            const gainSdB = 20 * Math.log10(Math.max(0.01, gS / 100)) + 20 * Math.log10(Math.max(0.01, volFactor)) + rcaBoostDB;

            // Individual curves (raw, no gain ‚Äî same as before)
            const kitData = [], mbData = [], twData = [], subData = [];
            freqs.forEach(f => {
                const mb = midBassResponse(f) + hpf12(f, hpf);
                const tw = tweeterResponse(f) + hpf12(f, hpf);
                const kit = 10 * Math.log10(Math.pow(10, mb / 10) + Math.pow(10, tw / 10));
                const sub = subResponse(f) + lpf12(f, lpf);
                kitData.push({ x: f, y: kit });
                mbData.push({ x: f, y: mb });
                twData.push({ x: f, y: tw });
                subData.push({ x: f, y: sub });
            });
            chartIndividual.data.datasets[0].data = kitData;
            chartIndividual.data.datasets[1].data = mbData;
            chartIndividual.data.datasets[2].data = twData;
            chartIndividual.data.datasets[3].data = subData;
            chartIndividual.update('none');

            // Combined response
            const combinedData = [], targetData = [], upperData = [], lowerData = [];
            // Also calculate per-driver processed data for decomposition
            const decompSubData = [], decompMbData = [], decompTwData = [];
            freqs.forEach(f => {
                const mb = midBassResponse(f) + hpf12(f, hpf) + gainFdB;
                const tw = tweeterResponse(f) + hpf12(f, hpf) + gainFdB;
                const frontLin = Math.pow(10, mb / 10) + Math.pow(10, tw / 10);
                const sub = subResponse(f) + lpf12(f, lpf) + gainSdB;
                const subLin = Math.pow(10, sub / 10);
                const totalLin = frontLin + subLin;
                const cabin = cabinTF(f);
                const totalDB = 10 * Math.log10(Math.max(1e-10, totalLin)) + cabin;
                combinedData.push({ x: f, y: totalDB });
                // Per-driver with cabin gain for decomposition
                decompSubData.push({ x: f, y: sub + cabin });
                decompMbData.push({ x: f, y: mb + cabin });
                decompTwData.push({ x: f, y: tw + cabin });
                const target = harmanTarget(f);
                targetData.push({ x: f, y: target });
                upperData.push({ x: f, y: target + 3 });
                lowerData.push({ x: f, y: target - 3 });
            });
            const ref1k = combinedData.find(d => d.x >= 1000);
            const offset = ref1k ? ref1k.y : 0;
            combinedData.forEach(d => d.y -= offset);
            // Apply same offset to decomp data
            decompSubData.forEach(d => d.y -= offset);
            decompMbData.forEach(d => d.y -= offset);
            decompTwData.forEach(d => d.y -= offset);

            chartCombined.data.datasets[0].data = combinedData;
            chartCombined.data.datasets[1].data = targetData;
            chartCombined.data.datasets[2].data = upperData;
            chartCombined.data.datasets[3].data = lowerData;
            chartCombined.update('none');

            // Decomposition chart
            chartDecomp.data.datasets[0].data = combinedData.map(d => ({ ...d }));
            chartDecomp.data.datasets[1].data = decompSubData;
            chartDecomp.data.datasets[2].data = decompMbData;
            chartDecomp.data.datasets[3].data = decompTwData;
            chartDecomp.data.datasets[4].data = targetData;
            chartDecomp.update('none');

            // Filters chart
            const hpfData = [], lpfData = [], xoLpf = [], xoHpf = [];
            freqs.forEach(f => {
                hpfData.push({ x: f, y: hpf12(f, hpf) });
                lpfData.push({ x: f, y: lpf12(f, lpf) });
                xoLpf.push({ x: f, y: lpf12(f, 3500) });
                xoHpf.push({ x: f, y: hpf12(f, 3500) });
            });
            chartFilters.data.datasets[0].data = hpfData;
            chartFilters.data.datasets[1].data = lpfData;
            chartFilters.data.datasets[2].data = xoLpf;
            chartFilters.data.datasets[3].data = xoHpf;
            chartFilters.update('none');

            // Update volume sensation table
            updateVolSensationTable(gF, gS, hpf, lpf);
        }

        window.addEventListener('load', initCharts);
    </script>
</body>

</html>
